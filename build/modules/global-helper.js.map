{
  "version": 3,
  "sources": ["../../src/modules/global-helper.ts"],
  "sourcesContent": ["import * as SentryObj from \"@sentry/types\";\r\n\r\nexport class GlobalHelper {\r\n\tAdapter: ioBroker.Adapter;\r\n\tSentry?: SentryObj.Hub;\r\n\tLanguage: string;\r\n\r\n\tconstructor(adapterInstance: ioBroker.Adapter, language: string) {\r\n\t\tthis.Adapter = adapterInstance;\r\n\t\tthis.Language = language;\r\n\t\t// Init Sentry\r\n\t\tif (this.Adapter.supportsFeature && this.Adapter.supportsFeature(\"PLUGINS\")) {\r\n\t\t\tconst sentryInstance: ioBroker.Plugin | null = this.Adapter.getPluginInstance(\"sentry\");\r\n\t\t\tif (sentryInstance) {\r\n\t\t\t\tthis.Sentry = sentryInstance.getSentryObject();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t//#region Helper Function ReportingError\r\n\t/**\r\n\t * Function for global error reporting\r\n\t * @param {Object} Err Error-Object\r\n\t * @param {string} FriendlyError Error message for user\r\n\t * @param {string} NameFunction Name of the function where error occured\r\n\t * @param {string} NameAction Name of the subfunction where error occured\r\n\t * @param {string} Info Contextual information\r\n\t * @param {boolean} ReportSentry Report error to sentry, default true\r\n\t */\r\n\tasync ReportingError(Err: Error | null, FriendlyError: string, NameFunction: string, NameAction = \"\", Info = \"\", ReportSentry = true): Promise<void> {\r\n\t\ttry {\r\n\t\t\tlet sErrMsg = `Error occured: ${FriendlyError} in ${NameFunction}`;\r\n\t\t\tif (NameAction !== \"\") sErrMsg = sErrMsg + `(${NameAction})`;\r\n\t\t\tif (Err !== null) sErrMsg = sErrMsg + ` [${Err}] [${Info}]`;\r\n\t\t\tthis.Adapter.log.error(sErrMsg);\r\n\t\t} catch (e) {\r\n\t\t\tthis.Adapter.log.error(`Exception in ErrorReporting [${e}]`);\r\n\t\t}\r\n\t\t// Sentry reporting\r\n\t\ttry {\r\n\t\t\tif (this.Sentry && this.Adapter.config.sentry_disable === false && ReportSentry === true) {\r\n\t\t\t\tthis.Sentry && this.Sentry.withScope(scope => {\r\n\t\t\t\t\tscope.setLevel(SentryObj.Severity.Error);\r\n\t\t\t\t\tscope.setExtra(\"NameFunction\", NameFunction);\r\n\t\t\t\t\tscope.setExtra(\"NameAction\", NameAction);\r\n\t\t\t\t\tif (Info) {\r\n\t\t\t\t\t\tscope.setExtra(\"Info\", Info);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//scope.setExtra(\"Config\", this.config);\r\n\t\t\t\t\tif (this.Sentry) {\r\n\t\t\t\t\t\tthis.Sentry.captureException(Err);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tthis.Adapter.log.error(`Exception in ErrorReporting Sentry [${e}]`);\r\n\t\t}\r\n\t}\r\n\t//#endregion\r\n\r\n\t//#region Helper Function ReportingInfo\r\n\t/**\r\n\t * Function for global information reporting\r\n\t * @param {\"Info\"|\"Debug\"} Level Level for ioBroker Logging\r\n\t * @param {string} Category Category of information\r\n\t * @param {string} Message Message\r\n\t * @param {{[Key: string]: any}|undefined} Data Contextual data information\r\n\t */\r\n\tReportingInfo(Level: \"Info\" | \"Debug\", Category: string, Message: string, Data?: { [Key: string]: any } | undefined): void {\r\n\t\tlet iobMessage = Message;\r\n\t\tif (this.Adapter.log.level === \"debug\" || this.Adapter.log.level === \"silly\") {\r\n\t\t\tiobMessage = `[${Category}] ${Message}`;\r\n\t\t}\r\n\t\tswitch (Level) {\r\n\t\t\tcase \"Debug\":\r\n\t\t\t\tthis.Adapter.log.debug(iobMessage);\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tthis.Adapter.log.info(iobMessage);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tthis.Sentry?.addBreadcrumb({\r\n\t\t\tcategory: Category,\r\n\t\t\tmessage: Message,\r\n\t\t\tlevel: Level as SentryObj.Severity,\r\n\t\t\tdata: Data\r\n\t\t})\r\n\t}\r\n\t//#endregion\r\n\r\n\tgetLanguage() {\r\n\t\treturn this.Language;\r\n\t}\r\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA,gBAA2B;AAEpB,mBAAmB;AAAA,EAKzB,YAAY,iBAAmC,UAAkB;AAChE,SAAK,UAAU;AACf,SAAK,WAAW;AAEhB,QAAI,KAAK,QAAQ,mBAAmB,KAAK,QAAQ,gBAAgB,YAAY;AAC5E,YAAM,iBAAyC,KAAK,QAAQ,kBAAkB;AAC9E,UAAI,gBAAgB;AACnB,aAAK,SAAS,eAAe;AAAA;AAAA;AAAA;AAAA,QAe1B,eAAe,KAAmB,eAAuB,cAAsB,aAAa,IAAI,OAAO,IAAI,eAAe,MAAqB;AACpJ,QAAI;AACH,UAAI,UAAU,kBAAkB,oBAAoB;AACpD,UAAI,eAAe;AAAI,kBAAU,UAAU,IAAI;AAC/C,UAAI,QAAQ;AAAM,kBAAU,UAAU,KAAK,SAAS;AACpD,WAAK,QAAQ,IAAI,MAAM;AAAA,aACf,GAAP;AACD,WAAK,QAAQ,IAAI,MAAM,gCAAgC;AAAA;AAGxD,QAAI;AACH,UAAI,KAAK,UAAU,KAAK,QAAQ,OAAO,mBAAmB,SAAS,iBAAiB,MAAM;AACzF,aAAK,UAAU,KAAK,OAAO,UAAU,WAAS;AAC7C,gBAAM,SAAS,UAAU,SAAS;AAClC,gBAAM,SAAS,gBAAgB;AAC/B,gBAAM,SAAS,cAAc;AAC7B,cAAI,MAAM;AACT,kBAAM,SAAS,QAAQ;AAAA;AAGxB,cAAI,KAAK,QAAQ;AAChB,iBAAK,OAAO,iBAAiB;AAAA;AAAA;AAAA;AAAA,aAIxB,GAAP;AACD,WAAK,QAAQ,IAAI,MAAM,uCAAuC;AAAA;AAAA;AAAA,EAahE,cAAc,OAAyB,UAAkB,SAAiB,MAAiD;AApE5H;AAqEE,QAAI,aAAa;AACjB,QAAI,KAAK,QAAQ,IAAI,UAAU,WAAW,KAAK,QAAQ,IAAI,UAAU,SAAS;AAC7E,mBAAa,IAAI,aAAa;AAAA;AAE/B,YAAQ;AAAA,WACF;AACJ,aAAK,QAAQ,IAAI,MAAM;AACvB;AAAA;AAEA,aAAK,QAAQ,IAAI,KAAK;AACtB;AAAA;AAEF,eAAK,WAAL,mBAAa,cAAc;AAAA,MAC1B,UAAU;AAAA,MACV,SAAS;AAAA,MACT,OAAO;AAAA,MACP,MAAM;AAAA;AAAA;AAAA,EAKR,cAAc;AACb,WAAO,KAAK;AAAA;AAAA;",
  "names": []
}
